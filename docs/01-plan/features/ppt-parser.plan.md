# Plan: ppt-parser

> PPT 파일에서 텍스트, 이미지, 테이블을 추출하는 파서 모듈

## 1. Overview

| Item | Description |
|------|-------------|
| Feature Name | ppt-parser |
| Type | Core Module |
| Priority | High |
| Status | Plan |
| Created | 2026-02-18 |

## 2. Problem Statement

### 2.1 Current State
- `modules/parser.py`에 기본 PPT 파싱 기능 구현됨
- python-pptx 라이브러리 사용
- 텍스트, 이미지, 테이블 추출 기능 존재

### 2.2 Issues / Gaps
1. **에러 핸들링 부족**: 파일 손상, 비밀번호 보호된 PPT 처리 미흡
2. **메모리 관리**: 대용량 PPT 파일 처리 시 메모리 최적화 부재
3. **형식 제한**: `.ppt` (구버전) 형식 미지원
4. **추출 품질**: SmartArt, 차트 내 텍스트 추출 불완전
5. **성능**: 대량 슬라이드 처리 시 성능 측정/최적화 없음

### 2.3 Goals
- 안정적인 PPT 파일 파싱 (에러 처리 강화)
- 다양한 콘텐츠 유형 지원 확대
- 성능 최적화 및 메모리 관리

## 3. Requirements

### 3.1 Functional Requirements

| ID | Requirement | Priority | Notes |
|----|-------------|----------|-------|
| FR-01 | 슬라이드 텍스트 추출 | Must | 현재 구현됨 |
| FR-02 | 이미지 추출 및 Base64 변환 | Must | 현재 구현됨 |
| FR-03 | 테이블 데이터 추출 | Must | 현재 구현됨 |
| FR-04 | 차트 존재 여부 감지 | Should | 현재 플래그만 |
| FR-05 | SmartArt/다이어그램 텍스트 추출 | Could | 미구현 |
| FR-06 | 노트(발표자 노트) 추출 | Could | 미구현 |
| FR-07 | 슬라이드 마스터/레이아웃 정보 추출 | Won't | 스코프 외 |

### 3.2 Non-Functional Requirements

| ID | Requirement | Target | Notes |
|----|-------------|--------|-------|
| NFR-01 | 파일 크기 제한 | 50MB | Streamlit 업로드 제한 고려 |
| NFR-02 | 처리 시간 | < 30초 (100슬라이드 기준) | UX 기준 |
| NFR-03 | 에러 복구 | 손상된 슬라이드 스킵 후 계속 | 견고성 |
| NFR-04 | 지원 형식 | .pptx (Office 2007+) | .ppt는 스코프 외 |

## 4. Scope

### 4.1 In Scope
- 기존 parser.py 기능 유지 및 개선
- 에러 핸들링 강화
- 발표자 노트 추출 추가
- 차트 데이터 추출 개선

### 4.2 Out of Scope
- `.ppt` (구버전) 형식 지원
- 비밀번호 보호된 파일 해제
- 애니메이션/전환 효과 추출
- 동영상/오디오 추출

## 5. Dependencies

### 5.1 External Dependencies
| Dependency | Version | Purpose |
|------------|---------|---------|
| python-pptx | 1.0.2+ | PPT 파일 파싱 |
| Pillow | 10.0+ | 이미지 처리 |

### 5.2 Internal Dependencies
| Module | Dependency Type |
|--------|-----------------|
| generator.py | 파싱된 데이터 소비 |
| chatbot.py | 파싱된 데이터 소비 |
| app.py | 파서 함수 호출 |

## 6. Risks & Mitigations

| Risk | Impact | Probability | Mitigation |
|------|--------|-------------|------------|
| 대용량 파일 메모리 이슈 | High | Medium | 청크 단위 처리, 스트리밍 |
| 손상된 PPT 파일 | Medium | Low | try-except로 슬라이드별 처리 |
| 복잡한 차트 데이터 손실 | Low | Medium | 차트 이미지로 대체 추출 |

## 7. Success Metrics

| Metric | Target | Measurement |
|--------|--------|-------------|
| 텍스트 추출 성공률 | > 99% | 테스트 PPT 샘플 |
| 이미지 추출 성공률 | > 95% | 테스트 PPT 샘플 |
| 처리 시간 | < 30초/100슬라이드 | 성능 테스트 |
| 에러 복구율 | 100% (스킵 후 계속) | 손상 파일 테스트 |

## 8. Implementation Notes

### 8.1 Current Functions (modules/parser.py)
```python
- extract_slide_content(uploaded_file) -> List[Dict]  # 메인 함수
- extract_image(shape) -> Optional[Dict]              # 이미지 추출
- extract_table(table) -> List[List[str]]             # 테이블 추출
- get_media_type(ext) -> str                          # MIME 타입
- get_slide_text_combined(slide_data) -> str          # 텍스트 결합
- get_all_text_content(slides_data) -> str            # 전체 텍스트
- get_slides_with_images(slides_data) -> List         # 이미지 필터
- prepare_vision_content(slide_data) -> List          # Vision API용
```

### 8.2 Proposed Enhancements
1. **에러 핸들링**: 슬라이드별 try-except 래핑
2. **발표자 노트**: `slide.notes_slide.notes_text_frame.text` 추출
3. **차트 개선**: 차트 제목/라벨 추출 시도
4. **로깅**: 파싱 과정 로깅 추가

## 9. Next Steps

1. [ ] Design 문서 작성 (`/pdca design ppt-parser`)
2. [ ] 기존 코드 분석 및 테스트 케이스 정의
3. [ ] 개선 사항 구현
4. [ ] Gap 분석 및 검증

---

*Document generated by bkit PDCA*
